var KObservableObject=function(){var r=function(){return function(r,t,y){function l(a,g,c,d,b,z,A,e){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=g;this.arguments=z;this.type=c;this.listener=A;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=d;this.oldValue=b;this.stopChange=e}function m(a,g,c,d){this.stopPropogation=function(){this._stopPropogration=
!0};this.preventDefault=function(){this._preventDefault=!0};this.type=a;this.key=g;this.event=c;this.args=d}function u(a,g){var c=k[g];return function(d,g){var b=new l(this,n(c)?d:"",a,n(c)?this[d]:"",n(c)?this[d]:"",arguments),b=new m(a,n(c)?d:"",b,arguments),e;!0!==h(b)&&(n(c)?(void 0===c[b.key]&&(c[b.key]=[]),e=c[b.key],e.push(b.args[1])):v(c)&&(void 0===c["*"]&&(c["*"]=[]),e=b.args[1]&&"*"===b.args[1]?c["*"]:c,e.push(b.args[0])));return this}}function w(a,g){var c=k[g];return function(d,g){var b=
new l(this,d,a,this[d],this[d],arguments),b=new m(a,d,b,arguments),e;if(!0!==h(b))if(n(c)){if(e=c[b.key])for(var f=0,k=e.length;f<k;f++)if(e[f].toString()===b.args[1].toString()){e.splice(f,1);break}}else if(v(c))for(void 0===c["*"]&&(c["*"]=[]),e=b.args[1]&&"*"===b.args[1]?c["*"]:c,f=0,k=e.length;f<k;f++)if(e[f].toString()===b.args[0].toString()){e.splice(f,1);break}return this}}function n(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function v(a){return"object"===
typeof a&&!!a&&a.constructor.toString()===Array.toString()}function B(a,g,c){return{get:function(){return a[g]},set:function(c){(this._stopChange?a.stopChange():a)[g]=c;this._stopChange=void 0},enumerable:c.enumerable,configurable:c.configurable}}function b(a,g,c){return{value:a,writable:!!g,enumerable:!1,configurable:!!c}}function x(a,g){var c=a,d=a;return{get:function(){return c},set:function(a){var b=new l(this,g,"set",a,c,arguments,"__kblisteners",this._stopChange);!0!==p(b)&&(d=c,c=a,b.stopChange||
(b.listener="__kbupdatelisteners",b.type="update",p(b)),this._stopChange||this.callSubscribers(g,c,d));this._stopChange=void 0},configurable:!0,enumerable:!0}}var k={},e={},q={add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],subscribe:[],unsubscribe:[],addDataListener:[],removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},h=function(a){for(var b=0,c=q[a.type],
d=c.length;b!==d&&(c[b](a),!a._stopPropogration);b++);return a._preventDefault},f=function(a,b){if(!b._stopPropogration&&a)for(var c=0,d=a.length;c!==d&&(a[c](b),!b._stopPropogration);c++);},p=function(a){var b=a.local[a.listener];n(b)?(f(b[a.key],a),"__kblisteners"===a.listener?(f(b["*"],a),a.fromListener="__kblisteners",a.listener="__kbparentlisteners",f(a.local[a.listener][a.key],a),f(a.local[a.listener]["*"],a)):"__kbupdatelisteners"===a.listener&&(f(b["*"],a),a.fromListener="__kbupdatelisteners",
a.listener="__kbparentupdatelisteners",f(a.local[a.listener][a.key],a),f(a.local[a.listener]["*"],a))):v(b)&&(f(b,a),f(b["*"],a));return a._preventDefault};Object.defineProperties(k,{__kbname:b(r||"",!0,!0),__kbref:b(t?t.__kbref||t:k,!0,!0),__kbscopeString:b(y||"",!0,!0),__kbImmediateParent:b(t||null,!0,!0),add:b(function(a,b){var c=new l(this,a,"add",b,void 0,arguments,"__kbdatacreatelisteners"),d=new m("add",a,c,arguments);!0!==h(d)&&(void 0===this[d.key]?!0!==p(c)&&(Object.defineProperty(this,
d.key,x.call(this,d.args[1],d.key)),d.type="postadd",h(d)):console.error("Your attempting to add the property: ",d.key," that already exists on",this,"try using set or direct set instead"));return this}),addPointer:b(function(a,b,c){var d=new l(this,c||b,"add",a[b],void 0,arguments,"__kbdatacreatelisteners"),e=new m("add",c||b,d,arguments);!0!==h(e)&&!0!==p(d)&&(d=Object.getOwnPropertyDescriptor(a,b),Object.defineProperty(this,e.key,B(a,b,d)),e.type="postadd",h(e));return this}),prototype:b(function(a,
g){void 0===this[a]?Object.defineProperty(this.__proto__,a,b(g,!0,!0)):console.error("Your attempting to add the your method with the prop: ",a," that already exists");return this}),set:b(function(a,b){var c=new l(this,a,"set",b,this[a],arguments,"__kblisteners"),d=new m("set",a,c,arguments);void 0===this[a]?this.add(d.key,d.args[1]):!0!==h(d)&&(c.key=d.key,c.value=d.args[1],!0!==p(c)&&(void 0===Object.getOwnPropertyDescriptor(this,d.key).value?this[d.key]=d.args[1]:Object.defineProperty(this,d.key,
x.call(this,d.args[1],d.key)),d.type="postset",h(d)));return this}),remove:b(function(a){var b=new l(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),c=new m("remove",a,b,arguments);if(!0!==h(c)){if(void 0===this[c.key])return console.error("Your attempting to remove the property: ",c.key," that does not exist on ",this),this;!0!==p(b)&&(Object.defineProperty(this,c.key,{value:null,writable:!0,enumerable:!0,configurable:!0}),c.type="postremove",h(c))}return this}),stringify:b(function(){var a=
[];return JSON.stringify(this,function(b,c){if(v(c)||n(c)){if(-1!==a.indexOf(c))return;a.push(c)}return c})}),callSubscribers:b(function(a,b,c){if(void 0!==e[a])for(var d=0,f=e[a].length;d<f;d++)e[a][d](a,b,c);if(void 0!==e["*"])for(d=0,f=e["*"].length;d<f;d++)e["*"][d](a,b,c);return this}),subscribe:b(function(a,b){var c=new l(this,a,"subscribe",this[a],void 0,arguments),c=new m("subscribe",a,c,arguments);!0!==h(c)&&(void 0===e[c.key]&&(e[c.key]=[]),e[c.key].push(b));return this}),unsubscribe:b(function(a,
b){var c=new l(this,a,"unsubscribe",this[a],void 0,arguments),c=new m("unsubscribe",a,c,arguments);if(!0!==h(c)&&void 0!==e[c.key]){var d=0,f=e[c.key].length;a:for(;d<f;d++)if(e[c.key][d].toString()===b.toString()){e[c.key].splice(d,1);break a}}return this}),__kblisteners:b({}),__kbupdatelisteners:b({}),__kbparentlisteners:b({}),__kbparentupdatelisteners:b({}),__kbdatacreatelisteners:b([]),__kbdatadeletelisteners:b([]),addActionListener:b(function(a,b){-1!==Object.keys(q).indexOf(a)?q[a].push(b):
console.error("There is no action listener by the name: ",a);return this}),removeActionListener:b(function(a,b){if(-1!==Object.keys(q).indexOf(a))for(var c=0,d=q[a],e=d.length;c!==e;c++){if(d[c].toString()===b.toString()){d.splice(c,1);break}}else console.error("There is no action listener by the name: ",a);return this}),onadd:b(function(){},!0),onremove:b(function(){},!0),onset:b(function(){},!0),onupdate:b(function(){},!0),stopChange:b(function(){this._stopChange=!0;return this})});Object.defineProperties(k,
{addDataListener:b(u("addDataListener","__kblisteners")),removeDataListener:b(w("removeDataListener","__kblisteners")),addDataUpdateListener:b(u("addDataUpdateListener","__kbupdatelisteners")),removeDataUpdateListener:b(w("removeDataUpdateListener","__kbupdatelisteners")),addDataCreateListener:b(u("addDataCreateListener","__kbdatacreatelisteners")),removeDataCreateListener:b(w("removeDataCreateListener","__kbdatacreatelisteners")),addDataRemoveListener:b(u("addDataRemoveListener","__kbdatadeletelisteners")),
removeDataRemoveListener:b(w("removeDataRemoveListener","__kbdatadeletelisteners"))});return k}}();window.define&&window.require?define([],function(){return r}):window.module&&(module.exports=r);return r}();
